---
layout: post
title: "java/static block and no static block"
date: 2017-07-12 17:26:56 +0800
comments: true
categories: 
---

## java 静态代码块和静态方法区别
1. 一般情况下,如果有些代码必须在项目启动的时候就执行的时候,需要使用静态代码块,这种代码是主动执行的;
2. 需要在项目启动的时候就初始化,在不创建对象的情况下,其他程序来调用的时候,需要使用静态方法,这种代码是被动执行的;
3. 静态方法在类加载的时候就已经加载 可以用类名直接调用;

所以：两者的区别就是:·静态代码块是自动执行的·;·静态方法是被调用的时候才执行的·.

## 静态方法
Java里，可以定义一个不需要创建对象的方法，这种方法就是静态方法。要实现这样的效果，只需要在类中定义的方法前加上static关键字。例如：

```java
public static int maximum(int n1,int n2){

}
```
特点：
1. 在静态方法里只能直接调用同类中其他的静态成员（包括变量和方法），而不能直接访问类中的非静态成员。这是因为，对于非静态的方法和变量，需要先创建类的实例对象后才可使用，而静态方法在使用前不用创建任何对象。
2. 静态方法不能以任何方式引用this和super关键字，因为静态方法在使用前不用创建任何实例对象，当静态方法调用时，this所引用的对象根本没有产生。
3. 静态变量是属于整个类的变量而不是属于某个对象的。注意不能把任何方法体内的变量声明为静态.

## 静态代码块

一个类可以使用不包含在任何方法体中的静态代码块。

特点：

1. 当类被载入时，静态代码块被执行，且只被执行一次; 
2. 静态块常用来执行类属性的初始化。

## 类装载步骤
在Java中，类装载器把一个类装入Java虚拟机中，要经过三个步骤来完成：装载、链接和初始化，其中链接又可以分成校验、准备和解析三步，除了解析外，其它步骤是严格按照顺序完成的，各个步骤的主要工作如下：

1. 装载：查找和导入类或接口的二进制数据；
2. 链接：执行下面的校验、准备和解析步骤，其中解析步骤是可以选择的；
3. 校验：检查导入类或接口的二进制数据的正确性；
4. 准备：给类的静态变量分配并初始化存储空间；
5. 解析：将符号引用转成直接引用；
6. 初始化：激活类的静态变量的初始化Java代码和静态Java代码块。初始化类中属性是静态代码块的常用用途，但只能使用一次。

```java
public class StaticBlock {
	public static void main(String[] args) {
		new Child();
	}
}

class Parent {
	static String name = "hello";

	{
		System.out.println("parent block");
	}

	static {
		System.out.println("parent static block");
	}

	public Parent(String name) {
		System.out.println("parent constructor");
	}
}

class Child extends Parent {
	static String childName = "hello";

	{
		System.out.println("child block");
	}

	static {
		System.out.println("child static block");
	}

	public Child() {
		super("child2parent");
		System.out.println("child constructor");
	}
}
```

### 分析
当执行new Child()时，它首先去看父类里面有没有静态代码块，如果有，它先去执行父类里面静态代码块里面的内容，当父类的静态代码块里面的内容执行完毕之后，接着去执行子类(自己这个类)里面的静态代码块，当子类的静态代码块执行完毕之后，它接着又去看父类有没有非静态代码块，如果有就执行父类的非静态代码块，父类的非静态代码块执行完毕，接着执行父类的构造方法；父类的构造方法执行完毕之后，它接着去看子类有没有非静态代码块，如果有就执行子类的非静态代码块。子类的非静态代码块执行完毕再去执行子类的构造方法，这个就是一个对象的初始化顺序。

### 总结
对象的初始化顺序:首先执行父类静态的内容，父类静态的内容执行完毕后，接着去执行子类的静态的内容，当子类的静态内容执行完毕之后，再去看父类有没有非静态代码块，如果有就执行父类的非静态代码块，父类的非静态代码块执行完毕，接着执行父类的构造方法；父类的构造方法执行完毕之后，它接着去看子类有没有非静态代码块，如果有就执行子类的非静态代码块。子类的非静态代码块执行完毕再去执行子类的构造方法。总之一句话，静态代码块内容先执行，接着执行父类非静态代码块和构造方法，然后执行子类非静态代码块和构造方法。

### 注意
子类的构造方法，不管这个构造方法带不带参数，默认的它都会先去寻找父类的不带参数的构造方法。如果父类没有不带参数的构造方法，那么子类必须用supper关键子来调用父类带参数的构造方法，否则编译不能通过。